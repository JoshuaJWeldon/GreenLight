package greenlight;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Dictionary;
import java.util.Hashtable;

public class MySqlControler {
	
	Connection connection;
	ResultSet  resultSet;
	
	public MySqlControler(){
		
		String host     = "jdbc:mysql://173.194.252.106:3306";
		String user     = "root";
		String password = "StrongHtr&7";
		
		String sql = "use greenlight";
		
		try{
	
			connection = DriverManager.getConnection(host,user,password);
			resultSet = connection.createStatement().executeQuery(sql);
			resultSet.close();
		}
		catch(SQLException e){System.err.println("DatabaseControler.DatabaseControler could not connect to database");}
		
	}
	
	/**
	 * insert into users (firstname,lastname,phone) values ('tim','burton','3937839454')
	 */
	public boolean insert(String[] columns, String[] values){
		
		String sql = "insert into users (";
		
		for(String column: columns)
			sql += column + ",";
		
		sql = sql.substring(0, sql.length() - 1) + ") values (";
		
		
		System.out.println(query);
		try {connection.createStatement().execute(query); System.out.println("ok?");resultSet.close();} 
		catch (SQLException e) {System.out.println(e.getMessage());return false;}
		
		return true;
		
	}
}
